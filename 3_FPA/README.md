This guidance shows how to reproduce the flux potential analysis (FPA) result in Fig 6 by FPA. Additionally, we provided a walkthrough guidance for running FPA on the generic model of iCEL1314 as well as any other metabolic network model, with any given expression dataset.

### Reproducing the FPA result for C. elegans' dual tissue model

This script helps run FPA for all seven C. elegans tissues. Used input files are indicated in the walkthrough script [here](writeFluxPotential_dual.m). In short,three main input files are used, [the dual version of iCEL1314](./../input/Tissue.mat), [the distance matrix](input/distance_raw.mat) and [expression table](input/expressionTable.tsv). The distance matrix is generated by the [distance generator](./../MetabolicDistance). Due to the file size limits of GitHub, we supply the compressed distance matrix in ".mat" format for reproducing purpose. One can also use the output from the distance generator directly. Please see relative section in the walkthrough script for details. 

To reproduce the FPA result, simply run:
```
matlab < writeFluxPotential_dual.m
```
Output(Flux distribution and other metrics) will be written in FPA_rxns.mat

### Run FPA on generic C. elegans model with a given expression dataset

We provided a step-by-step [walkthrough script](FPA_walkthrough_generic.m) for running FPA on the generic iCEL1314 with any given expression dataset. Users can start with this script to perform FPA analysis on their own expression data. 

This walkthrough script will guide users to generate FPA predictions from plain expression matrix (i.e, TPM matrix) to the final predicted FPA values for given target rxn(s). We recommand to go over this script interactively in MATLAB graphic interface. Please launch a MATLAB instance and set your current directory in this folder (3_FPA). Then, open and go through [walkthrough script](FPA_walkthrough_generic.m) according to the instructions in it.

Users may choose to generate the distance matrix for generic iCEL1314 via [metabolic distance calculator](./../MetabolicDistance). In this walkthrough script, we will directly use the completed output (see details in the script)for the sake of time. (calculating full distance matrix may take hours) For making the required input from a COBRA format model loaded in matlab, please see "2. generate the distance matrix" section in the walkthrough script. This section will guide user to make the required inputs for running the distance calculator.

### Run FPA on other metabolic model with a given expression dataset

We provided a walkthrough guidance of how to run the FPA analysis on human metabolic model RECON 2.2. The expression profile of NCI-60 Cancer Cell lines [Reinhold WC et all, 2019](https://cancerres.aacrjournals.org/content/79/13/3514.long) was used as an example.
/*To be completed.*/
