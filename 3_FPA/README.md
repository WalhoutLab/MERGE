This guidance shows how to reproduce the flux potential analysis (FPA) result in Fig X by FPA. Additionally, we provided a walkthrough guidence for running FPA on the generic model of iCEL1314 as well as any other metabolic network model.

### Run the integration for dual model

This script helps run FPA for all seven C. elegans tissues. Used input files are indicated in the walkthrough script [here](writeFluxPotential_dual.m). In short,three main input files are used, [the dual version of iCEL1314](./../input/Tissue.mat), [the distance matrix](input/distance_raw.mat) and [expression table](input/expressionTable.tsv). The distance matrix is generated by the [distance generator](./../MetabolicDistance). Due to the file size limits of GitHub, we supply the compressed distance matrix in ".mat" format for reproducing purpose. One can also use the output from the distance generator directly. Please see relative section in the walkthrough script for details. 

To reproduce the FPA result, simply run:
```
matlab < writeFluxPotential_dual.m
```
Output(Flux distribution and other metrics) will be written in FPA_rxns.mat

To run simple FPA for generic iCEL1314 or other metabolic network reconstructions, please follow the instructions in [walkthrough for generic model](writeFluxPotential_generic.m). This walkthrough script will guide users to generate FPA predictions from plain expression matrix (i.e, TPM matrix) and a CORBRA format model to the final predicted FPA values for target rxn(s).

